expose :
tt NumKeystracked : uword = 6;

State : 
	type : u32;
	enum :
		None,
		Released,
		Pressed,
		PressHeld
	;
;

KeySignalState :
	union
	{
		struct :
			Up,
			Down,
			Left,
			Right,
			Enter,
			Tab : bool;
		;
		Array type : [NumKeysTracked] bool;
	}
;

RingBuffer :
	alias Size : uword = 10;;

	State type : [StateBufferSize] State;
	Index type : uword;
;

Event         type : proc (State);
Subscriptions type : DArray<ptr Event>;

Data :
	CurrentState, PreviousState type : KeySignalState;
	
	KeyStates    type : [NumKeysTracked] State;
	KeyEventSubs type : [NumKeysTracked] Subscriptions;
;
/- expose -/;

expose proc :
	GetContext -> ptr Data;
	
	LoadModule;	Update;
	
	(_key : OS.KeyCode, _callback : ptr Event) :
		Subscribe; Unsubscribe;
	;
;


// Defined within input context
expose proc :
	(_key : OS.KeyCode, _callback : ptr Event) :
		Subscribe;
	;
;

// Director - Scope - Parameters - Identifier
// Parsed Order: D-S-P-I
// CSV Order: I-D-S-P
// I, D, S, P, ParamsHASH, DefHASH
// I, D, S, P, NumOfParams, Params, DefHASH    (Alternative Format)
Subscribe, expose, Input, proc, 2, OS.KeyCode, ptr<Event>, ##########

